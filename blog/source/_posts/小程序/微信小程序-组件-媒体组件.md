---
title: 微信小程序-组件-媒体组件
date: 2018-05-15 13:22:48
tags: 微信小程序
categories: 小程序
---

一、Audio		
1.属性	
	
|属性名|类型|默认值|说明|
|---|---|---|---|
|id|String||audio组件的唯一标志符|	
|src|String||音频资源地址|
|loop|Boolean||是否循环播放|
|controls| Boolean ||是否显示默认控件|
|poster| String ||默认控件上音频封面图片资源地址(controls=false,poster无效)|
|name| String |未知音频|默认控件上的音频名字(controls=false,poster无效)|
|author| String |未知作者|默认控件上的作者名字(controls=false,poster无效)|
|binderror|EvenHandle||当发生错误时触发 error 事件，detail = {errMsg: MediaError.code}|
|bindplay| EvenHandle ||当开始/继续播放时触发play事件|
|bindpause| EvenHandle ||当暂停播放时触发 pause 事件|
|bindtimeupdate| EvenHandle ||当播放进度改变时触发 timeupdate 事件，detail = {currentTime, duration}|
|bindended| EvenHandle ||当播放到末尾时触发 ended 事件|
				
2.错误码 MediaError.code
	
	1 - 获取资源被用户禁止
	2 - 网络错误
	3 - 解码错误
	4 - 不合适资源	
3.音频组件API

推荐V1.6.0+ wx.createInnerAudioContext() 

|方法|描述|只读|
|---|---|---|
|src|String|音频地址，用于直接播放||
|startTime|Number|开始播放位置，默认0，单位s||
|autoPlay|Boolean|默认false||
|loop| Boolean |是否循环播放，默认false||
|obeyMyteSwitch| Boolean |是否遵循系统静音开关，false即使用户打开静音开关也能发出声音，默认true|
|duration| Number |当前音频时长（s），src合法返回|
|currentTime| Number |当前音频的播放位置（单位：s），只有在当前有合法的 src 时返回，时间不取整，保留小数点后 6 位|
|paused| Boolean |当前是是否暂停或停止状态，true 表示暂停或停止，false 表示正在播放|
|buffered|Number|音频缓冲的时间点，仅保证当前播放时间点到此时间点内容已缓冲。|
|volume|Number|音量。范围 0~1|

innerAudioContext 对象的方法列表：

	方法	参数	说明
	play	无	播放	
	pause	无	暂停	
	stop	无	停止	
	seek	position	跳转到指定位置，单位 s	
	destroy	无	销毁当前实例	
	onCanplay	callback	音频进入可以播放状态，但不保证后面可以流畅播放	
	onPlay	callback	音频播放事件	
	onPause	callback	音频暂停事件	
	onStop	callback	音频停止事件	
	onEnded	callback	音频自然播放结束事件	
	onTimeUpdate	callback	音频播放进度更新事件	
	onError	callback	音频播放错误事件	
	onWaiting	callback	音频加载中事件，当音频因为数据不足，需要停下来加载时会触发	
	onSeeking	callback	音频进行 seek 操作事件	
	onSeeked	callback	音频完成 seek 操作事件	
	offCanplay	callback	取消监听 onCanplay 事件	1.9.0
	offPlay	callback	取消监听 onPlay 事件	1.9.0
	offPause	callback	取消监听 onPause 事件	1.9.0
	offStop	callback	取消监听 onStop 事件	1.9.0
	offEnded	callback	取消监听 onEnded 事件	1.9.0
	offTimeUpdate	callback	取消监听 onTimeUpdate 事件	1.9.0
	offError	callback	取消监听 onError 事件	1.9.0
	offWaiting	callback	取消监听 onWaiting 事件	1.9.0
	offSeeking	callback	取消监听 onSeeking 事件	1.9.0
	offSeeked	callback	取消监听 onSeeked 事件

errCode 说明

	10001 		系统错误
	10002 		网络错误
	10003 		文件错误
	10004		格式错误
	-1			未知错误
	
	

不推荐V1.6.0-  wx.createAudioContext(audioId, this) 

|方法|参数|描述|
|---|---|---|
|setSrc|src|音频地址|
|play||播放|
|pause||暂停|
|seek|position|跳转指定位置，单位s|
4.eg		
![audio](audio.png)		

```html
parents.wxml

<view class='myAudio'>
	<audio 
		poster='https://tao1010.github.io/image/avatar.gif' 
		name='此时此刻' 
		author='许巍' 
		src='http://ws.stream.qqmusic.qq.com/M500001VfvsJ21xFqb.mp3?guid=ffffffff82def4af4b12b3cd9337d5e7&uin=346897220&vkey=6292F51E1E384E06DCBDC9AB7C49FD713D632D313AC4858BACB8DDD29067D3C601481D36E62053BF8DFEAF74C0A5CCFADD6471160CAF3E6A&fromtag=46' 
		id='audio' 
		controls='true' 
		loop='true'>
	</audio>

	<slider 
		step='1' 
		bindchange='quickPlay' 
		value='{{value}}' 
		min='0' 
		max='{{max}}' 
		show-value='true'></slider>
	
	<button type='primary' bindtap='audioPlay'>播放</button>
	<button type='primary' bindtap='audioPause'>暂停</button>
	<button type='primary' bindtap='audioStart'>重新播放</button>
</view>
```
```js
parents.js

quickPlay: function(e){

    console.log(e.detail.value)
    this.audioCtx.seek(e.detail.value)
  },
  audioPlay: function(){

    this.audioCtx.play()
  },
  audioPause: function(){
    this.audioCtx.pause()
  },
  audioStart: function(){
    this.audioCtx.seek(0)
  },
  /**
   * 生命周期函数--监听页面加载
   */
  onLoad: function (options) {

    // template.tabar("tabBar",4,this)//0 表示第一个tabbar
    // 使用 wx.createAudioContext 获取 audio 上下文 context
    this.audioCtx = wx.createAudioContext("audio", this)
    // this.audioCtx = wx.createInnerAudioContext();
    max = this.audioCtx.detail.duration;
    // console.log(this.audioCtx.detail);
  },

```
二、Video组件		
1.[组件属性](https://developers.weixin.qq.com/miniprogram/dev/component/video.html)		

	 <view>
	  <view class='title'>1-402前</view>
	  <video class='video1' src='{{videoSrcFront}}'>视频监控</video>
	</view>
	<view>
	  <view class='title'>2-205后</view>
	  <video class='video2' src='{{videoSrc}}' controls='true' danmu-btn='true' enable-danmu='true' danmu-list='{{list}}'>视频监控</video>
	</view> 
2.注意
	
	video组件是由客户端创建的原生组件，层级最高，不能通过z-index控制层级；
	不能在scroll-view、swiper、picker-view、movable-view中使用；
	css动画在video组件中无效；
	默认宽度300px、高度225px，可通过wxss设置宽高；
3.API
	






参考资料：		
1.[Audio](https://developers.weixin.qq.com/miniprogram/dev/component/audio.html)    
2.[音频组件API](https://developers.weixin.qq.com/miniprogram/dev/api/api-audio.html)    
3.[音频进度条](https://blog.csdn.net/Wu_shuxuan/article/details/78285875?locationNum=5&fps=1)    